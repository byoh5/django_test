{% include "common/header.html" %}
{% load static %}
<div class="wrap">
    <section class="sub_visual">
        <div class="section_wrap">
            <div class="slogan">
                        <span class="bigSlg">
                            코딩 라운지
                        </span>
                <p>
                    다른 학생들은 어떤 작품을 만들었을까?<br/>
                    동영상으로 확인해보세요!
                </p>
            </div>
            <img class="subVisual codingLounge" src="{% static 'resource/img/sub/sv_review.png' %}" alt="코딩라운지">
        </div>
    </section>
<!-- sub visual -->

<!-- codingLounge list -->
    <div class="codingLounge_list">
        <div class="filter_area fixed">
            <div class="search_area">
                <div class="input_area_lounge">
                     <input type="text" name="search_box" id="search_box" placeholder="검색어 입력해주세요.">
                      &nbsp;<button type="button" onclick="javascript:goLounge(1, 0);"  style="width:40px; height:40px;">
                        <img src="{% static 'resource/img/sub/ico_search.png' %}" alt="검색" >
                       </button>
                </div>
            </div>
        </div>

        <ul class="thumb_list">
             {% for loungeList in lounge_list %}
            <li>
                <a href="javascript:void(0);" onclick="javascript:goloungeView('{{loungeList.video_id}}');" class="btn brd_detail">
                    <img src="/static/resource/img/lounge/{{loungeList.data_name}}/{{loungeList.img}}" alt="코딩 라운지 리스트 썸네일" style="width:400px; height:200px;">
                </a>
                <div class="text_area">
                    <span class="search">{{loungeList.search_title}}</span>
                    <span class="title">{{loungeList.title}}</span>
                    <p class="writer">Project by {{loungeList.user}}</p>
                </div>
            </li>
            {%endfor%}
        </ul>
    </div>

     <div class="page">
        <ul id="paging" class="pagination modal"></ul>
    </div>

    {% include "common/banner_bottom.html" %}
    {% include "common/footer.html" %}
</div>
    <script>
        $(document).ready(function() {

            var page = '{{last_page}}';
            var cur_page = '{{paging_num}}';

            page *= 1;

            for(var i = 1; i <= page; i ++)
            {
                if(i == cur_page)
                    document.getElementById('paging').innerHTML += "<li><a href='javascript:void(0);' onclick='javascript:goLounge(" + i + ", 1);' class='active num' >" + i + "</a></li>";
                else
                    document.getElementById('paging').innerHTML += "<li><a href='javascript:void(0);' onclick='javascript:goLounge(" + i + ", 1);' class='num' >" + i + "</a></li>";
            }

           $("#search_box").keypress(function (e) {
            if (e.which == 13){
                 goLounge(1, 0);  // 실행할 이벤트
            }
            });
        });

        function goLounge(paging_num, total_cnt)
        {
            var searchBox = $('[name=search_box]').val()
            var newForm = $('<form></form>');

            if(total_cnt == 1)
                total_cnt = '{{total_count}}';

            newForm.attr("name", "lounge_search");
            newForm.attr("method", "post");
            newForm.attr("action", "/lounge_page_paging/");

            newForm.append($('<input/>', {type: 'hidden', name: 'csrfmiddlewaretoken', value : '{{ csrf_token }}'}));
            newForm.append($('<input/>', {type: 'hidden', name: 'lounge_all_cnt', value : total_cnt }));
            newForm.append($('<input/>', {type: 'hidden', name: 'paging_num', value : paging_num }));
            newForm.append($('<input/>', {type: 'hidden', name: 'search_input', value : searchBox }));

            newForm.appendTo('body');
            newForm.submit();

        }

        function goloungeView(video)
        {
            var newForm = $('<form></form>');

            newForm.attr("name", "lounge_form");
            newForm.attr("method", "post");
            newForm.attr("action", "/lounge_view/");

            newForm.append($('<input/>', {type: 'hidden', name: 'csrfmiddlewaretoken', value : '{{ csrf_token }}'}));
            newForm.append($('<input/>', {type: 'hidden', name: 'lounge_video', value : video }));

            newForm.appendTo('body');
            newForm.submit();
        }
    </script>


</body>
</html>
